{{- define "main" -}}

<div class="main-container">
    <div class="main-left">
        {{- if .Site.Params.homeInfoParams -}}
            {{- partial "home_info.html" . -}}
        {{- end -}}

        <div class="posts-list">
            {{ $pages := where .Site.RegularPages "Type" "in" .Site.Params.mainSections }}

            {{/* 1. 单独显示所有置顶文章 */}}
            {{ range where $pages "Params.pin" true }}
                {{ partial "series_overview_card.html" . }}
            {{ end }}

            {{/*
            ===================================================================
             使用兼容性更强的写法来筛选“非置顶”文章
            ===================================================================
            */}}
            {{/* 2. 创建一个包含了所有置顶文章 ID 的列表 */}}
            {{ $pinned_pages := where $pages "Params.pin" true }}

            {{/* 3. 筛选出所有“不属于”置顶列表的文章 */}}
            {{ $regular_pages := where $pages "not in" $pinned_pages }}
            
            {{/* 4. 对这个“非置顶”文章列表进行分页和显示 */}}
            {{ $paginator := .Paginate $regular_pages }}
            {{ range $paginator.Pages }}
                {{ .Render "summary" }}
            {{ end }}
        </div>

        {{- template "_internal/pagination.html" . -}}
    </div>
</div>

{{- end }}{{/* end main */ -}}