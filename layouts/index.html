{{- define "main" -}}

<div class="main-container">
    <div class="main-left">
        {{- if .Site.Params.homeInfoParams -}}
            {{- partial "home_info.html" . -}}
        {{- end -}}

        <div class="posts-list">
            {{/* 1. 找到所有文章 */}}
            {{ $pages := where .Site.RegularPages "Type" "in" .Site.Params.mainSections }}

            {{/* 2. 单独显示所有置顶文章 */}}
            {{ range where $pages "Params.pin" true }}
                {{ partial "series_overview_card.html" . }}
            {{ end }}

            {{/*
            ===================================================================
             这是最关键的、经过修正的逻辑
            ===================================================================
            */}}
            {{/* 3. 创建一个只包含“非置顶”文章的新列表 */}}
            {{ $regular_pages := $pages.Complement (where $pages "Params.pin" true) }}
            
            {{/* 4. 对这个“非置顶”文章列表进行分页和显示 */}}
            {{ $paginator := .Paginate $regular_pages }}
            {{ range $paginator.Pages }}
                {{ .Render "summary" }}
            {{ end }}
        </div>

        {{- template "_internal/pagination.html" . -}}
    </div>
</div>

{{- end }}{{/* end main */ -}}